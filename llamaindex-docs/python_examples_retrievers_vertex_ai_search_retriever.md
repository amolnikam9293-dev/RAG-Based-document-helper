[Skip to content](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#_top)
# Vertex AI Search Retriever 
This notebook walks you through how to setup a Retriever that can fetch from Vertex AI search datastore
### Pre-requirements
[Section titled “Pre-requirements”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#pre-requirements)
  * Set up a Google Cloud project
  * Set up a Vertex AI Search datastore
  * Enable Vertex AI API


### Install library
[Section titled “Install library”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#install-library)
```


%pip install llama-index-retrievers-vertexai-search


```

### Restart current runtime
[Section titled “Restart current runtime”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#restart-current-runtime)
To use the newly installed packages in this Jupyter runtime, you must restart the runtime. You can do this by running the cell below, which will restart the current kernel.
```

# Colab only


# Automatically restart kernel after installs so that your environment can access the new packages



import IPython





app = IPython.Application.instance()




app.kernel.do_shutdown(True)


```

### Authenticate your notebook environment (Colab only)
[Section titled “Authenticate your notebook environment (Colab only)”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#authenticate-your-notebook-environment-colab-only)
If you are running this notebook on Google Colab, you will need to authenticate your environment. To do this, run the new cell below. This step is not required if you are using [Vertex AI Workbench](https://cloud.google.com/vertex-ai-workbench).
```

# Colab only



import sys





if"google.colab"in sys.modules:




from google.colab import auth





auth.authenticate_user()


```

```

# If you're using JupyterLab instance, uncomment and run the below code.


#!gcloud auth login

```

```


from llama_index.retrievers.vertexai_search import VertexAISearchRetriever




# Please note it's underscore '_' in vertexai_search

```

### Set Google Cloud project information and initialize Vertex AI SDK
[Section titled “Set Google Cloud project information and initialize Vertex AI SDK”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#set-google-cloud-project-information-and-initialize-vertex-ai-sdk)
To get started using Vertex AI, you must have an existing Google Cloud project and [enable the Vertex AI API](https://console.cloud.google.com/flows/enableapi?apiid=aiplatform.googleapis.com).
Learn more about [setting up a project and a development environment](https://cloud.google.com/vertex-ai/docs/start/cloud-environment).
```


PROJECT_ID="{your project id}"# @param {type:"string"}




LOCATION="us-central1"# @param {type:"string"}




import vertexai





vertexai.init(project=PROJECT_ID,location=LOCATION)


```

### Test Structured datastore
[Section titled “Test Structured datastore”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#test-structured-datastore)
```


DATA_STORE_ID="{your id}"# @param {type:"string"}




LOCATION_ID="global"


```

```


struct_retriever =VertexAISearchRetriever(




project_id=PROJECT_ID,




data_store_id=DATA_STORE_ID,




location_id=LOCATION_ID,




engine_data_type=1,



```

```


query ="harry potter"




retrieved_results = struct_retriever.retrieve(query)


```

```


print(retrieved_results[0])


```

### Test Unstructured datastore
[Section titled “Test Unstructured datastore”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#test-unstructured-datastore)
```


DATA_STORE_ID="{your id}"




LOCATION_ID="global"


```

```


unstruct_retriever =VertexAISearchRetriever(




project_id=PROJECT_ID,




data_store_id=DATA_STORE_ID,




location_id=LOCATION_ID,




engine_data_type=0,



```

```


query ="alphabet 2018 earning"




retrieved_results2 = unstruct_retriever.retrieve(query)


```

```


print(retrieved_results2[0])


```

### Test Website datastore
[Section titled “Test Website datastore”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#test-website-datastore)
```


DATA_STORE_ID="{your id}"




LOCATION_ID="global"




website_retriever =VertexAISearchRetriever(




project_id=PROJECT_ID,




data_store_id=DATA_STORE_ID,




location_id=LOCATION_ID,




engine_data_type=2,



```

```


query ="what's diamaxol"




retrieved_results3 = website_retriever.retrieve(query)


```

```


print(retrieved_results3[0])


```

## Use in Query Engine
[Section titled “Use in Query Engine”](https://developers.llamaindex.ai/python/examples/retrievers/vertex_ai_search_retriever/#use-in-query-engine)
```

# import modules needed



from llama_index.core import Settings




from llama_index.llms.vertex import Vertex




from llama_index.embeddings.vertex import VertexTextEmbedding


```

```


vertex_gemini =Vertex(




model="gemini-1.5-pro",




temperature=0,




context_window=100000,




additional_kwargs={},




# setup the index/query llm



Settings.llm = vertex_gemini


```

```


from llama_index.core.query_engine import RetrieverQueryEngine





query_engine = RetrieverQueryEngine.from_args(struct_retriever)


```

```


response = query_engine.query("Tell me about harry potter")




print(str(response))


```

